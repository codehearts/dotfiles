# This .muttrc is intended for use with offlineimap and msmtp.
# It also assumes vim as the editor and that urlview is installed.

# Replace <real_name> with your own real name.

# Folder Hooks --------------------
folder-hook ~/Mail/Gmail 'source ~/.mutt/gmail_config'
folder-hook ~/Mail/School 'source ~/.mutt/school_config'
folder-hook ~/Mail/Custom 'source ~/.mutt/custom_config'

# Accounts -------------------------
account-hook ~/Mail/Gmail 'source ~/.mutt/gmail_config'
account-hook ~/Mail/School 'source ~/.mutt/school_config'
account-hook ~/Mail/Custom 'source ~/.mutt/custom_config'

# Folders --------------------------
set folder				= "~/Mail"
set alias_file			= "~/.mutt/aliases"
set header_cache		= "~/.cache/mutt"
set message_cachedir	= "~/.cache/mutt"
set mailcap_path		= "~/.mutt/mailcap"
set tmpdir				= "~/.mutt/temp"

# Basic Options --------------------
set wait_key		= no
set mbox_type		= Maildir
set delete			# Don't ask about deleting
unset confirmappend	# Don't ask about appending attachments
unset mark_old		# I only want read/new statuses
set beep_new
set pipe_decode		# Strip headers and eval mimes when piping
set thorough_search	# Strip headers and eval mimes before searching
set text_flowed     = yes # Prevent automatic linebreaking in plaintext
set display_filter  = "~/.mutt/add_sender_to_aliases.sh"

# Sidebar --------------------------
set sidebar_delim	= ' '
set sidebar_visible	= yes
set sidebar_width	= 24
color sidebar_new color221 color223

# Sidebar Navigation ---------------
bind index,pager <down>		sidebar-next
bind index,pager <up>		sidebar-prev
bind index,pager <right>	sidebar-open

# Aliases --------------------------
set sort_alias		= alias
set reverse_alias	= yes
source $alias_file

# Sort by Threads ------------------
set sort			= threads
set sort_aux		= reverse-last-date-received
set sort_re			# Thread based on regex
set reply_regexp	= "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set uncollapse_jump	# Don't collapse threads on unread messages

# Status Bar -----------------------
set status_chars	= " *%A"
set status_format	= "---[ Folder: %f ]---[%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]---%>-%?p?( %p postponed )?---"

# Header Options -------------------
ignore *
unignore from: to: cc: bcc: date: subject:
unhdr_order *
hdr_order from: to: cc: bcc: date: subject: # Set the ordering

# Index View Options ---------------
set date_format		= "%b %d"
set index_format	= "[%Z] %D %-20.20F %s"

# Index Key Bindings ---------------
bind index gg		first-entry
bind index G		last-entry
bind index R		group-reply
bind index <tab>	sync-mailbox
bind index <space>	collapse-thread
macro index O		"<shell-escape>offlineimap<enter>" "sync all mail with offlineimap"
macro index o		"<shell-escape>offlineimap -qf INBOX<enter>" "sync inbox with offlineimap"
bind index "#"		toggle-new

# Pager View Options ---------------
set pager_index_lines	= 10
set pager_context		= 3 # Number of context lines to show
set pager_stop			# Don't go to the next message automatically
set menu_scroll
unset markers			# Remove the plus signs
set quote_regexp		= "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
alternative_order text/plain text/enriched text/html

# Pager Key Bindings ---------------
bind pager k	previous-line
bind pager j	next-line
bind pager gg	top
bind pager G	bottom
bind pager R	group-reply
bind attach <return> view-mailcap # View attachments properly

# Attachments ----------------------
# Use ctrl-u to open links in an email
macro pager \Cu "|urlview<enter>" "call urlview to open links"

# Compose Options ------------------
set fast_reply
set fcc_attach		# Save attachments with the body
unset mime_forward	# Forward attachments as part of the body
set forward_format	= "Fwd: %s"
set forward_decode	# Decode when forwarding
set attribution		= "On %d, %n wrote:" # Quote header
set reply_to		# Reply to the Reply to: field
set reverse_name	# Reply as whoever the message was sent to
set include			# Include message in replies
set forward_quote	# Include message in forwards
set send_charset	= "utf-8"
set realname		= "<real_name>"
set edit_headers	= yes
set editor			= "vim +/^$ -c start" # Start in insert mode

# Postponing ------------------------
bind compose p	postpone-message
bind index p	recall-message

# Searching -------------------------
bind index N search-opposite
bind pager N search-opposite

# Mail Settings --------------------
set timeout			= 3 # Idle time before scanning
set mail_check		= 0 # Minimum time between scans

# SMTP Settings --------------------
set sendmail_wait	= 0 # Wait for msmtp to finish

# Colors ----------------------------
source ~/.mutt/loveless-theme
